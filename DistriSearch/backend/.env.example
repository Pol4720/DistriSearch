# =============================================================================
# DistriSearch Backend - Configuración de Variables de Entorno
# =============================================================================
# Copia este archivo como .env y ajusta los valores según tu entorno

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DE RED Y ACCESO EXTERNO
# -----------------------------------------------------------------------------

# URL pública del backend (para acceso desde otras máquinas)
# Cuando ejecutas en red local, usa la IP de tu máquina
# Ejemplo: PUBLIC_URL=https://192.168.1.100:8000
# Si usas localhost solo tú podrás acceder
PUBLIC_URL=http://localhost:8000

# IP externa/pública de esta máquina (para detección automática)
# El sistema intentará detectarla automáticamente si no se especifica
# Ejemplo: EXTERNAL_IP=192.168.1.100
EXTERNAL_IP=

# -----------------------------------------------------------------------------
# CONFIGURACIÓN SSL/TLS (HTTPS)
# -----------------------------------------------------------------------------

# Habilitar SSL/TLS (HTTPS)
# true = Usa HTTPS, false = Usa HTTP
ENABLE_SSL=false

# Rutas a los certificados SSL
# Genera los certificados con: powershell .\scripts\generate_ssl_certs.ps1
SSL_CERT_FILE=../certs/distrisearch.crt
SSL_KEY_FILE=../certs/distrisearch.key

# -----------------------------------------------------------------------------
# CONFIGURACIÓN DEL SERVIDOR
# -----------------------------------------------------------------------------

# Host del backend (0.0.0.0 permite conexiones externas)
BACKEND_HOST=0.0.0.0

# Puerto del backend
BACKEND_PORT=8000

# Habilitar auto-reload en desarrollo (desactivar en producción)
RELOAD=false

# -----------------------------------------------------------------------------
# SEGURIDAD Y AUTENTICACIÓN
# -----------------------------------------------------------------------------

# API Key para endpoints administrativos (opcional)
# Si no se define, los endpoints admin no requieren autenticación (¡SOLO PARA DEV!)
ADMIN_API_KEY=

# -----------------------------------------------------------------------------
# MODO CENTRAL Y CARPETA COMPARTIDA
# -----------------------------------------------------------------------------

# Auto-escanear carpeta compartida al iniciar
CENTRAL_AUTO_SCAN=false

# Ruta a la carpeta compartida central
CENTRAL_SHARED_FOLDER=../central_shared

# -----------------------------------------------------------------------------
# MANTENIMIENTO Y REPLICACIÓN
# -----------------------------------------------------------------------------

# Intervalo de tareas de mantenimiento (en segundos)
# Verifica timeouts de nodos y ejecuta replicación
MAINTENANCE_INTERVAL_SECONDS=300

# -----------------------------------------------------------------------------
# DHT (DISTRIBUTED HASH TABLE)
# -----------------------------------------------------------------------------

# Auto-iniciar DHT al arrancar el backend
# true = Inicia automáticamente, false = Manual desde API o frontend
DHT_AUTO_START=false

# Modo de operación DHT:
# - "external": Llama a un servicio DHT externo vía HTTP (DHT_HTTP_URL)
# - "inproc": Importa y ejecuta un Peer DHT dentro del proceso del backend
DHT_MODE=external

# URL del servicio DHT externo (solo si DHT_MODE=external)
# Debe apuntar al servidor Flask de DHT/main.py
DHT_HTTP_URL=http://127.0.0.1:8080

# Puerto del Peer DHT (solo si DHT_MODE=inproc)
DHT_PORT=2000

# Buffer size para DHT (bytes)
DHT_BUFFER=4096

# Bits para el espacio de hash DHT (2^bits = máximo nodos)
DHT_MAX_BITS=10

# Auto-unirse a una seed DHT al iniciar (opcional)
# Solo si DHT_AUTO_START=true
DHT_SEED_IP=
DHT_SEED_PORT=2000

# -----------------------------------------------------------------------------
# FRONTEND (para referencia)
# -----------------------------------------------------------------------------

# URL del backend desde el frontend
# Debe coincidir con PUBLIC_URL para acceso externo
DISTRISEARCH_BACKEND_URL=http://localhost:8000

# URL pública del backend (alternativa)
DISTRISEARCH_BACKEND_PUBLIC_URL=http://localhost:8000

# API Key para llamadas desde el frontend (si ADMIN_API_KEY está definida)
DISTRISEARCH_ADMIN_API_KEY=

# -----------------------------------------------------------------------------
# EJEMPLO DE CONFIGURACIÓN PARA RED LOCAL CON HTTPS
# -----------------------------------------------------------------------------

# Descomenta y ajusta estos valores para habilitar HTTPS en red local:
# PUBLIC_URL=https://192.168.1.100:8000
# EXTERNAL_IP=192.168.1.100
# ENABLE_SSL=true
# SSL_CERT_FILE=../certs/distrisearch.crt
# SSL_KEY_FILE=../certs/distrisearch.key
# DISTRISEARCH_BACKEND_URL=https://192.168.1.100:8000
# DISTRISEARCH_BACKEND_PUBLIC_URL=https://192.168.1.100:8000

# NOTAS IMPORTANTES:
# 1. Genera los certificados SSL con: powershell .\scripts\generate_ssl_certs.ps1
# 2. Los certificados autofirmados mostrarán advertencia en el navegador
# 3. Para producción, usa certificados de Let's Encrypt u otra CA válida
# 4. Asegúrate de que el firewall permita el tráfico en el puerto configurado
